DROP TABLE truong_oils;

--1--
CREATE TABLE truong_oils (
    NGAY_THANG DATE,
    LOAI VARCHAR2(200),
    GIABAN NUMBER,
    TON_KHO NUMBER,
    GIA_TRI NUMBER,
    CUA_HANG VARCHAR2(200),
    QUAN_HUYEN VARCHAR2(200)
);

--2--
INSERT INTO truong_oils VALUES (TO_DATE('8/31/2020', 'mm/dd/YYYY'), 'RON 95-IV', 15210, 324, 4928040.00, 'CHXD SO 74', 'Thanh Tri');
INSERT INTO truong_oils VALUES (TO_DATE('8/31/2020', 'mm/dd/YYYY'), 'RON 95-III', 14920, 754, 11249680.00, 'CHXD SO 74', 'Thanh Tri');
INSERT INTO truong_oils VALUES (TO_DATE('8/31/2020', 'mm/dd/YYYY'), 'E5 RON 92-II', 14400, 324, 52502400.00, 'CHXD SO 74', 'Thanh Tri');
INSERT INTO truong_oils VALUES (TO_DATE('8/31/2020', 'mm/dd/YYYY'), 'DIEZEN', 12450, 324, 43985850.00, 'CHXD SO 74', 'Thanh Tri');
INSERT INTO truong_oils VALUES (TO_DATE('8/31/2020', 'mm/dd/YYYY'), 'DAU HOA', 10200, 324, 23908800.00, 'CHXD SO 74', 'Thanh Tri');
INSERT INTO truong_oils VALUES (TO_DATE('8/31/2020', 'mm/dd/YYYY'), 'MAZUT', 11380, 324, 38942360.00, 'CHXD SO 74', 'Thanh Tri');

INSERT INTO truong_oils VALUES (TO_DATE('8/31/2020', 'mm/dd/YYYY'), 'RON 95-IV', 15210, 3323, 50542830.00, 'CHXD SO 75', 'Hoang Mai');
INSERT INTO truong_oils VALUES (TO_DATE('8/31/2020', 'mm/dd/YYYY'), 'RON 95-III', 14920, 2344, 34972480.00, 'CHXD SO 75', 'Hoang Mai');
INSERT INTO truong_oils VALUES (TO_DATE('8/31/2020', 'mm/dd/YYYY'), 'E5 RON 92-II', 14400, 3555, 51192000.00, 'CHXD SO 75', 'Hoang Mai');
INSERT INTO truong_oils VALUES (TO_DATE('8/31/2020', 'mm/dd/YYYY'), 'DIEZEN', 12450, 866, 10781700.00, 'CHXD SO 75', 'Hoang Mai');
INSERT INTO truong_oils VALUES (TO_DATE('8/31/2020', 'mm/dd/YYYY'), 'DAU HOA', 10200, 7657, 78101400.00, 'CHXD SO 75', 'Hoang Mai');
INSERT INTO truong_oils VALUES (TO_DATE('8/31/2020', 'mm/dd/YYYY'), 'MAZUT', 11380, 9534, 108496920.00, 'CHXD SO 75', 'Hoang Mai');

INSERT INTO truong_oils VALUES (TO_DATE('8/31/2020', 'mm/dd/YYYY'), 'RON 95-IV', 15210, 575, 8745750.00, 'CHXD SO 85', 'Long Bien');
INSERT INTO truong_oils VALUES (TO_DATE('8/31/2020', 'mm/dd/YYYY'), 'RON 95-III', 14920, 6456, 96323520.00, 'CHXD SO 85', 'Long Bien');
INSERT INTO truong_oils VALUES (TO_DATE('8/31/2020', 'mm/dd/YYYY'), 'E5 RON 92-II', 14400, 5345, 76968000.00, 'CHXD SO 85', 'Long Bien');
INSERT INTO truong_oils VALUES (TO_DATE('8/31/2020', 'mm/dd/YYYY'), 'DIEZEN', 12450, 234, 2913300.00, 'CHXD SO 85', 'Long Bien');
INSERT INTO truong_oils VALUES (TO_DATE('8/31/2020', 'mm/dd/YYYY'), 'DAU HOA', 10200, 4244, 43288800.00, 'CHXD SO 85', 'Long Bien');
INSERT INTO truong_oils VALUES (TO_DATE('8/31/2020', 'mm/dd/YYYY'), 'MAZUT', 11380, 2424, 27585120.00, 'CHXD SO 85', 'Long Bien');


--3--
SELECT DISTINCT NGAY_THANG FROM truong_oils;
SELECT DISTINCT LOAI FROM truong_oils;
SELECT DISTINCT CUA_HANG FROM truong_oils;
SELECT COUNT(*) FROM truong_oils
WHERE QUAN_HUYEN='Long Bien';

--4--
ALTER TABLE truong_oils
RENAME COLUMN NGAY_THANG
TO NGAY_BAO_CAO;

ALTER TABLE truong_oils
RENAME COLUMN GIA_TRI
TO GIA_TRI_VND;

--5--
UPDATE truong_oils
SET TON_KHO=1900
WHERE LOAI='RON 95-IV' 
AND NGAY_BAO_CAO=TO_DATE('31/08/2020','dd/mm/YYYY');

--6--
UPDATE truong_oils
SET GIA_TRI_VND = TON_KHO * GIABAN
WHERE LOAI='RON 95-IV'
AND NGAY_BAO_CAO=TO_DATE('31/08/2020','dd/mm/YYYY');

--7--
DELETE FROM truong_oils
WHERE LOAI='DIEZEN'
AND CUA_HANG IN ('CHXD SO 60', 'CHXD SO 74');

--8--
DELETE FROM truong_oils
WHERE LOAI='MAZUT' AND TON_KHO < 11380;

--9--
CREATE TABLE TRUONG_OILS_BACKUP_31802020 AS
SELECT * FROM truong_oils
WHERE NGAY_BAO_CAO=TO_DATE('31/08/2020','DD/MM/YYYY');

--10--
TRUNCATE TABLE truong_oils;

--11--
DROP TABLE truong_oils;